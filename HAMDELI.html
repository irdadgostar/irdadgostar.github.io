<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="سامانه تعالی همدلی، پلتفرم رسمی مشارکت‌های مردمی موسسه تعالی اندیشه و رشد جهت حمایت از نیازمندان.">
  <title>سامانه تعالی همدلی</title>
  
  <!-- فونت وزیرمتن (نسخه رسمی) -->
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
  <!-- آیکون‌ها -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- فریم‌ورک بوت‌استرپ 5 (نسخه راست‌چین) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
  <!-- پاپ‌آپ‌های زیبا -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    :root {
      --primary-color: #1e3a8a; /* آبی نفتی رسمی */
      --secondary-color: #bfdbfe; /* آبی روشن */
      --accent-color: #d4af37; /* طلایی (نماد تعالی) */
      --text-dark: #1f2937;
      --bg-light: #f3f4f6;
    }

    body {
      font-family: 'Vazirmatn', sans-serif;
      background-color: var(--bg-light);
      color: var(--text-dark);
      overflow-x: hidden;
    }

    /* هدر سایت */
    .header-section {
      background: linear-gradient(135deg, var(--primary-color) 0%, #1e40af 100%);
      color: white;
      padding: 3rem 1rem 5rem 1rem;
      text-align: center;
      border-radius: 0 0 30px 30px;
      box-shadow: 0 10px 30px rgba(30, 58, 138, 0.2);
      position: relative;
    }

    .institute-link {
      background-color: rgba(255,255,255,0.1);
      padding: 5px 15px;
      border-radius: 50px;
      color: var(--accent-color);
      text-decoration: none;
      font-size: 0.9rem;
      transition: 0.3s;
      border: 1px solid rgba(212, 175, 55, 0.3);
    }

    .institute-link:hover {
      background-color: var(--accent-color);
      color: var(--primary-color);
    }

    .main-title {
      font-weight: 900;
      margin-top: 15px;
      font-size: 2.2rem;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    /* کارت اصلی */
    .main-card {
      background: white;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.05);
      margin-top: -3rem;
      border: none;
      overflow: hidden;
    }

    /* تب‌ها */
    .nav-pills .nav-link {
      color: var(--text-dark);
      font-weight: bold;
      border-radius: 0;
      padding: 15px;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
    }

    .nav-pills .nav-link.active {
      background-color: transparent;
      color: var(--primary-color);
      border-bottom: 3px solid var(--accent-color);
    }

    .nav-pills .nav-link:hover {
      background-color: #f8fafc;
    }

    .nav-icon {
      font-size: 1.2rem;
      margin-left: 8px;
      color: var(--accent-color);
    }

    /* فرم‌ها */
    .form-control, .form-select {
      border-radius: 10px;
      padding: 12px;
      border: 1px solid #e5e7eb;
      background-color: #f9fafb;
    }

    .form-control:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
    }

    .btn-submit {
      background: var(--primary-color);
      color: white;
      border-radius: 12px;
      padding: 14px;
      font-weight: bold;
      font-size: 1.1rem;
      width: 100%;
      border: none;
      box-shadow: 0 4px 15px rgba(30, 58, 138, 0.3);
      transition: transform 0.2s;
    }

    .btn-submit:hover {
      background-color: #172554;
      transform: translateY(-2px);
    }

    /* فوتر */
    .footer {
      text-align: center;
      padding: 30px 0;
      color: #6b7280;
      font-size: 0.9rem;
    }
    
    .footer a {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: bold;
    }

    .info-box {
      background-color: #eff6ff;
      border-right: 4px solid var(--primary-color);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 0.9rem;
      color: #1e40af;
    }
  </style>
</head>
<body>

  <!-- هدر رسمی -->
  <header class="header-section">
    <div class="container">
      <a href="https://tashacol.ir" target="_blank" class="institute-link">
        <i class="fas fa-university"></i> وابسته به موسسه تعالی اندیشه و رشد
      </a>
      <h1 class="main-title">تعالی همدلی</h1>
      <p class="mt-2 opacity-75">سامانه هوشمند و شفاف مشارکت‌های مردمی</p>
    </div>
  </header>

  <!-- بدنه اصلی -->
  <div class="container" style="max-width: 700px;">
    <div class="card main-card p-2">
      
      <!-- ناوبری تب‌ها -->
      <ul class="nav nav-pills nav-fill mb-4" id="pills-tab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="tab-cash" data-bs-toggle="pill" data-bs-target="#content-cash" type="button">
            <i class="fas fa-hand-holding-dollar nav-icon"></i> حمایت مالی
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-goods" data-bs-toggle="pill" data-bs-target="#content-goods" type="button">
            <i class="fas fa-box-open nav-icon"></i> اهدای کالا
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-skills" data-bs-toggle="pill" data-bs-target="#content-skills" type="button">
            <i class="fas fa-user-graduate nav-icon"></i> نذر تخصص
          </button>
        </li>
      </ul>

      <div class="tab-content p-3" id="pills-tabContent">
        
        <!-- ۱. تب حمایت مالی -->
        <div class="tab-pane fade show active" id="content-cash">
          <div class="text-center mb-4">
            <img src="https://cdn-icons-png.flaticon.com/512/2953/2953363.png" alt="Donate" style="width: 80px; opacity: 0.8;">
            <h2 class="h5 mt-3 fw-bold">پرداخت آنلاین و مستقیم</h2>
          </div>
          
          <div class="info-box">
            <i class="fas fa-info-circle"></i> 
            اطلاعات شما جهت صدور رسید دیجیتال ثبت می‌شود. پس از زدن دکمه زیر، مستقیماً به درگاه امن بانکی هدایت می‌شوید.
          </div>

          <form id="form-cash" onsubmit="handleFormSubmit(event, 'cash')">
            <div class="mb-3">
              <label class="form-label small text-muted">نام و نام خانوادگی (اختیاری)</label>
              <div class="input-group">
                <span class="input-group-text bg-white"><i class="fas fa-user text-secondary"></i></span>
                <input type="text" class="form-control" name="name" placeholder="مثال: علی محمدی">
              </div>
            </div>
            <div class="mb-4">
              <label class="form-label small text-muted">شماره همراه (جهت اطلاع‌رسانی)</label>
              <div class="input-group">
                <span class="input-group-text bg-white"><i class="fas fa-mobile-alt text-secondary"></i></span>
                <input type="tel" class="form-control" name="phone" placeholder="0912..." required pattern="[0-9]{11}">
              </div>
            </div>
            <button type="submit" class="btn btn-submit">
              <i class="fas fa-lock ms-2"></i> ثبت و انتقال به درگاه پرداخت
            </button>
          </form>
        </div>

        <!-- ۲. تب اهدای کالا -->
        <div class="tab-pane fade" id="content-goods">
          <h2 class="h5 fw-bold mb-4 border-bottom pb-2">ثبت اهدای کالا و اقلام</h2>
          <form id="form-goods" onsubmit="handleFormSubmit(event, 'goods')">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label small text-muted">نام شریف شما</label>
                <input type="text" class="form-control" name="name" required>
              </div>
              <div class="col-md-6">
                <label class="form-label small text-muted">شماره تماس</label>
                <input type="tel" class="form-control" name="phone" required>
              </div>
              <div class="col-12">
                <label class="form-label small text-muted">نوع کالا</label>
                <select class="form-select" name="category" required>
                  <option value="" selected disabled>انتخاب کنید...</option>
                  <option value="مواد غذایی">مواد غذایی و ارزاق</option>
                  <option value="پوشاک">پوشاک و البسه</option>
                  <option value="لوازم خانگی">لوازم خانگی</option>
                  <option value="لوازم تحریر">لوازم تحریر و آموزشی</option>
                  <option value="دارو">دارو و تجهیزات پزشکی</option>
                  <option value="سایر">سایر موارد</option>
                </select>
              </div>
              <div class="col-12">
                <label class="form-label small text-muted">توضیحات و آدرس حدودی</label>
                <textarea class="form-control" name="desc" rows="3" placeholder="توضیحاتی در مورد اقلام و محدوده آدرس جهت دریافت..." required></textarea>
              </div>
            </div>
            <button type="submit" class="btn btn-submit mt-4">ثبت اطلاعات جهت هماهنگی</button>
          </form>
        </div>

        <!-- ۳. تب نذر تخصص -->
        <div class="tab-pane fade" id="content-skills">
          <h2 class="h5 fw-bold mb-4 border-bottom pb-2">بانک متخصصین خیر</h2>
          <div class="alert alert-light border small">
            با ثبت تخصص خود، در زمان نیاز موسسه به مهارت شما (پزشکی، آموزشی، فنی و...) با شما تماس گرفته می‌شود.
          </div>
          <form id="form-skills" onsubmit="handleFormSubmit(event, 'skills')">
            <div class="mb-3">
              <label class="form-label small text-muted">نام و نام خانوادگی</label>
              <input type="text" class="form-control" name="name" required>
            </div>
            <div class="mb-3">
              <label class="form-label small text-muted">شماره تماس</label>
              <input type="tel" class="form-control" name="phone" required>
            </div>
            <div class="mb-3">
              <label class="form-label small text-muted">زمینه تخصص</label>
              <input type="text" class="form-control" name="expertise" placeholder="مثال: دندانپزشک، معلم ریاضی، لوله‌کش..." required>
            </div>
            <div class="mb-3">
              <label class="form-label small text-muted">زمان‌های آزادسازی (حدودی)</label>
              <input type="text" class="form-control" name="availability" placeholder="مثال: پنجشنبه‌ها عصر">
            </div>
            <button type="submit" class="btn btn-submit mt-2">اعلام آمادگی همکاری</button>
          </form>
        </div>

      </div>
    </div>

    <!-- فوتر -->
    <footer class="footer">
      <p class="mb-1">کلیه حقوق محفوظ است &copy; 1403</p>
      <p>طراحی و توسعه توسط واحد فناوری <a href="https://tashacol.ir" target="_blank">موسسه تعالی اندیشه و رشد</a></p>
    </footer>
  </div>

  <!-- جاوا اسکریپت -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function handleFormSubmit(e, type) {
      e.preventDefault();
      
      const form = document.getElementById('form-' + type);
      const submitBtn = form.querySelector('button[type="submit"]');
      const originalBtnText = submitBtn.innerHTML;

      // تغییر وضعیت دکمه به حالت لودینگ
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> در حال پردازش...';

      // جمع‌آوری داده‌ها
      const formData = { type: type };
      new FormData(form).forEach((value, key) => formData[key] = value);

      google.script.run
        .withSuccessHandler((response) => {
          submitBtn.disabled = false;
          submitBtn.innerHTML = originalBtnText;

          if (response.status === 'success') {
            
            if (response.type === 'cash') {
              // نمایش پیام کوتاه و انتقال به درگاه
              Swal.fire({
                icon: 'success',
                title: 'ثبت شد',
                text: 'در حال انتقال امن به درگاه پرداخت...',
                timer: 2000,
                showConfirmButton: false,
                timerProgressBar: true
              }).then(() => {
                window.location.href = response.redirectUrl;
              });
            } else {
              // پیام موفقیت برای کالا و تخصص
              Swal.fire({
                icon: 'success',
                title: 'با تشکر از شما',
                text: response.message,
                confirmButtonText: 'بسیار عالی',
                confirmButtonColor: '#1e3a8a'
              });
              form.reset();
            }

          } else {
            Swal.fire({
              icon: 'error',
              title: 'خطا',
              text: 'متاسفانه مشکلی پیش آمد: ' + response.message
            });
          }
        })
        .withFailureHandler((error) => {
          submitBtn.disabled = false;
          submitBtn.innerHTML = originalBtnText;
          Swal.fire({
            icon: 'error',
            title: 'خطای ارتباط',
            text: 'لطفا اتصال اینترنت خود را بررسی کنید.'
          });
        })
        .processForm(formData);
    }
  </script>
</body>
  </html>
