<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ====================
       ADVANCED MULTILINGUAL SEO (Unaltered)
       ==================== -->
    <title>Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ± | Ù¾Ú˜ÙˆÙ‡Ø´â€ŒÙ‡Ø§ Ùˆ Ø¢Ø«Ø§Ø± (Amirhossein Dadgostar)</title>
    <meta name="description" content="Ø¢Ø±Ø´ÛŒÙˆ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ùˆ ÙˆØ¨â€ŒØ³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ± (Amirhossein Dadgostar). Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¢Ø«Ø§Ø± Ø¯Ø± Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù„ÙˆÙ… Ø§Ø³Ù„Ø§Ù…ÛŒØŒ Ù‚Ø±Ø¢Ù†â€ŒØ´Ù†Ø§Ø³ÛŒØŒ ÙÙ‚Ù‡ Ùˆ Ø­Ù‚ÙˆÙ‚.">
    <meta name="keywords" content="Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ±, Amirhossein Dadgostar, Amir Dadgostar, Ø£Ù…ÙŠØ± Ø­Ø³ÙŠÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ±, é˜¿ç±³å°”ä¾¯èµ›å› Â·è¾¾æˆˆæ–¯å¡”, à¤…à¤®à¥€à¤°à¤¹à¥‹à¤¸à¥ˆà¤¨ à¤¦à¤¾à¤¦à¤—à¥‹à¤¸à¥à¤¤à¤¾à¤°, ã‚¢ãƒŸãƒ«ãƒ•ã‚»ã‚¤ãƒ³ãƒ»ãƒ€ãƒ‰ã‚´ã‚¹ã‚¿ãƒ«, ì•„ë¯¸ë¥´í˜¸ì„¸ì¸ ë‹¤ë“œê³ ìŠ¤íƒ€ë¥´, Ù¾Ú˜ÙˆÙ‡Ø´Ú¯Ø± Ø§Ø³Ù„Ø§Ù…ÛŒ, Ø¹Ù„ÙˆÙ… Ø§Ø³Ù„Ø§Ù…ÛŒ">
    <meta name="author" content="Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ±">
    <link rel="canonical" href="https://irdadgostar.github.io/">
    <link rel="alternate" hreflang="fa" href="https://irdadgostar.github.io/">
    <link rel="alternate" hreflang="x-default" href="https://irdadgostar.github.io/">
    <meta property="og:title" content="Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ± | Ù¾Ú˜ÙˆÙ‡Ø´â€ŒÙ‡Ø§ Ùˆ Ø¢Ø«Ø§Ø± (Amirhossein Dadgostar)">
    <meta property="og:description" content="Ø¢Ø±Ø´ÛŒÙˆ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ø¢Ø«Ø§Ø± Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ± Ø¯Ø± Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù„ÙˆÙ… Ø§Ø³Ù„Ø§Ù…ÛŒØŒ Ù‚Ø±Ø¢Ù†â€ŒØ´Ù†Ø§Ø³ÛŒ Ùˆ ØªØ±Ø¨ÛŒØª.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://irdadgostar.github.io/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ± | Ù¾Ú˜ÙˆÙ‡Ø´â€ŒÙ‡Ø§ Ùˆ Ø¢Ø«Ø§Ø± (Amirhossein Dadgostar)">
    <meta name="twitter:description" content="Ø¢Ø±Ø´ÛŒÙˆ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ø¢Ø«Ø§Ø± Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ±.">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Person",
          "name": "Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ±",
          "url": "https://irdadgostar.github.io/",
          "sameAs": [],
          "jobTitle": "Ù¾Ú˜ÙˆÙ‡Ø´Ú¯Ø± Ùˆ Ù…Ø¤Ù„Ù",
          "description": "Ù¾Ú˜ÙˆÙ‡Ø´Ú¯Ø± Ø¯Ø± Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù„ÙˆÙ… Ø§Ø³Ù„Ø§Ù…ÛŒØŒ Ù‚Ø±Ø¢Ù†â€ŒØ´Ù†Ø§Ø³ÛŒØŒ ÙÙ‚Ù‡ Ùˆ Ø­Ù‚ÙˆÙ‚.",
          "alternateName": ["Amirhossein Dadgostar", "Amir Dadgostar"]
        },
        {
          "@type": "WebSite",
          "url": "https://irdadgostar.github.io/",
          "name": "Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ± | Ù¾Ú˜ÙˆÙ‡Ø´â€ŒÙ‡Ø§ Ùˆ Ø¢Ø«Ø§Ø±",
          "author": { "@type": "Person", "name": "Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ±" },
          "publisher": { "@type": "Person", "name": "Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ±" }
        }
      ]
    }
    </script>

    <!-- Preload Fonts for Performance -->
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

    <style>
        /* ====================
           NEW & IMPROVED STYLES
           ==================== */
        :root {
            --bg-color: #f8f9fa;
            --surface-color: #ffffff;
            --header-bg: #1a202c; /* Dark, professional header */
            --primary-color: #2563eb; /* A modern, vibrant blue */
            --primary-hover: #1d4ed8;
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --text-inverted: #edf2f7;
            --border-color: #e2e8f0;
            --shadow-color: rgba(0, 0, 0, 0.06);
            --font-family: 'Vazirmatn', -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            --border-radius: 12px; /* Softer corners */
            --transition-speed: 0.3s;
        }

        @font-face { font-family: 'Vazirmatn'; src: url('https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-Regular.woff2') format('woff2'); font-weight: 400; font-display: swap; }
        @font-face { font-family: 'Vazirmatn'; src: url('https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-Bold.woff2') format('woff2'); font-weight: 700; font-display: swap; }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 16px;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }

        /* ====================
           HEADER & NAVIGATION
           ==================== */
        .header {
            position: sticky; top: 0;
            width: 100%;
            background-color: var(--header-bg);
            z-index: 1000;
            padding: 1.25rem 0;
            border-bottom: 1px solid #2d3748;
        }
        .nav-container { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--text-inverted); text-decoration: none; }
        .nav-right { display: flex; align-items: center; gap: 1.5rem; }
        .nav-menu { display: flex; list-style: none; gap: 2rem; }
        .nav-link { color: #a0aec0; text-decoration: none; font-weight: 500; transition: color var(--transition-speed) ease; }
        .nav-link:hover { color: var(--text-inverted); }
        
        .archive-button {
            display: inline-block;
            background-color: var(--primary-color);
            color: #fff;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease;
        }
        .archive-button:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
        }

        /* ====================
           HERO SECTION
           ==================== */
        .hero-section {
            background-color: #fff;
            text-align: center;
            padding: 5rem 0;
            border-bottom: 1px solid var(--border-color);
        }
        .hero-section h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .hero-section p {
            font-size: 1.25rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 2.5rem auto;
        }

        .search-wrapper { position: relative; max-width: 600px; margin: 0 auto; }
        #search-input {
            width: 100%;
            padding: 1rem 1.5rem;
            font-family: var(--font-family);
            font-size: 1.1rem;
            border: 1px solid var(--border-color);
            border-radius: 50px; /* Pill shape */
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
            -webkit-appearance: none;
        }
        #search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15);
        }
        .search-wrapper::before {
            content: 'ğŸ”';
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: #9ca3af;
        }

        /* ====================
           PUBLICATIONS GRID
           ==================== */
        .page-section { padding: 5rem 0; }
        
        .publication-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2.5rem;
        }
        .publication-item {
            display: flex; flex-direction: column;
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px -1px var(--shadow-color), 0 2px 4px -2px var(--shadow-color);
            transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            cursor: pointer;
            overflow: hidden;
        }
        .publication-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1);
        }

        .item-image-wrapper { width: 100%; aspect-ratio: 16 / 9; position: relative; background-color: #f0f3f7; }
        .image-shimmer { position: absolute; inset: 0; background: linear-gradient(100deg, rgba(255,255,255,0) 20%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0) 80%), #f0f3f7; background-size: 200% 100%; animation: shimmer 1.5s infinite linear; }
        @keyframes shimmer { from { background-position: 200% 0; } to { background-position: -200% 0; } }
        .item-image { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 0.5s ease; }
        .item-image.loaded { opacity: 1; }

        .item-content { padding: 1.5rem; display: flex; flex-direction: column; flex-grow: 1; }
        .item-title-wrapper { flex-grow: 1; margin-bottom: 1rem; }
        .item-title { font-size: 1.25rem; font-weight: 700; line-height: 1.5; margin-bottom: 0.5rem; color: var(--text-primary); }
        .item-date { font-size: 0.9rem; color: var(--text-secondary); }
        #no-results { display: none; text-align: center; padding: 2rem; color: var(--text-secondary); }
        
        /* ====================
           MODAL
           ==================== */
        #modal-container { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background-color: rgba(0, 0, 0, 0.6); backdrop-filter: blur(5px); z-index: 10000; opacity: 0; transition: opacity var(--transition-speed) ease; }
        #modal-container.visible { opacity: 1; }
        #modal-content { background-color: var(--surface-color); width: 90%; max-width: 700px; max-height: 90vh; display: flex; flex-direction: column; border-radius: var(--border-radius); box-shadow: 0 5px 20px rgba(0,0,0,0.1); transform: scale(0.95); transition: transform var(--transition-speed) ease; }
        #modal-container.visible #modal-content { transform: scale(1); }
        #modal-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
        #modal-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); }
        #modal-close { background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--text-secondary); line-height: 1; }
        #modal-body { padding: 1.5rem; overflow-y: auto; }
        #modal-description-wrapper { background-color: #f8f9fa; border: 1px solid var(--border-color); padding: 1rem; border-radius: 8px; font-size: 0.95rem; }
        #modal-description-wrapper pre { margin: 0; white-space: pre-wrap; word-wrap: break-word; font-family: var(--font-family); }
        #modal-footer { padding: 1rem 1.5rem; border-top: 1px solid var(--border-color); text-align: left; flex-shrink: 0; }
        .view-button { display: inline-block; padding: 0.7rem 1.4rem; background-color: var(--primary-color); color: #fff; text-decoration: none; border-radius: 8px; font-weight: 600; transition: background-color var(--transition-speed); }
        .view-button:hover { background-color: var(--primary-hover); }

        /* ====================
           FOOTER
           ==================== */
        .footer { padding: 4rem 0; background-color: #eef2ff; border-top: 1px solid var(--border-color); }
        .footer-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 4rem; }
        .footer-col h3 { margin-bottom: 1.5rem; font-size: 1.2rem; }
        .footer-col p, .footer-col a { color: var(--text-secondary); text-decoration: none; }
        .footer-col a:hover { color: var(--primary-color); }
        .footer-bottom { text-align: center; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color); color: var(--text-secondary); font-size: 0.9rem; }
        
        /* ====================
           RESPONSIVENESS
           ==================== */
        @media (max-width: 768px) {
            .nav-menu { display: none; }
            .hero-section h1 { font-size: 2.5rem; }
            .footer-grid { grid-template-columns: 1fr; gap: 2.5rem; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container nav-container">
            <a href="#" class="logo">Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ±</a>
            <div class="nav-right">
                <nav>
                    <ul class="nav-menu">
                        <li><a href="#publications" class="nav-link">Ø¢Ø«Ø§Ø±</a></li>
                        <li><a href="#footer" class="nav-link">ØªÙ…Ø§Ø³</a></li>
                    </ul>
                </nav>
                <a href="https://drive.google.com/drive/folders/1mAAdly-AM4pP9YZwIrz_uyKwujTZABHc" target="_blank" rel="noopener noreferrer" class="archive-button">Ø¢Ø±Ø´ÛŒÙˆ Ú©Ø§Ù…Ù„</a>
            </div>
        </div>
    </header>

    <main>
        <section class="hero-section">
            <div class="container">
                <h1>Ø¢Ø±Ø´ÛŒÙˆ Ù¾Ú˜ÙˆÙ‡Ø´â€ŒÙ‡Ø§ Ùˆ Ø¢Ø«Ø§Ø±</h1>
                <p>Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§ØŒ Ù…Ù‚Ø§Ù„Ø§Øª Ùˆ Ù¾Ú˜ÙˆÙ‡Ø´â€ŒÙ‡Ø§ Ø¯Ø± Ø­ÙˆØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù</p>
                <div class="search-wrapper">
                    <input type="text" id="search-input" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ù…ÛŒØ§Ù† Ø¢Ø«Ø§Ø±...">
                </div>
            </div>
        </section>

        <section id="publications" class="page-section">
            <div class="container">
                <div id="publication-container" class="publication-grid">
                    <!-- Skeletons & Content will be injected here by JS -->
                </div>
                <p id="no-results">Ù‡ÛŒÚ† Ø§Ø«Ø±ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ù…Ø´Ø®ØµØ§Øª ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>
            </div>
        </section>
    </main>

    <footer id="footer" class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ù†</h3>
                    <p>Ù…Ù† Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ± Ù‡Ø³ØªÙ…ØŒ Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ Ø¨Ù‡ Ù¾Ú˜ÙˆÙ‡Ø´ Ø¯Ø± Ø²Ù…ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù. Ø§ÛŒÙ† ÙˆØ¨â€ŒØ³Ø§ÛŒØª Ø¢Ø±Ø´ÛŒÙˆÛŒ Ø§Ø² ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§ Ùˆ Ø¢Ø«Ø§Ø± Ù…Ù† Ø§Ø³Øª.</p>
                </div>
                <div class="footer-col">
                    <h3>ØªÙ…Ø§Ø³</h3>
                    <p>Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø§ÛŒÙ…ÛŒÙ„ Ø²ÛŒØ± Ø¨Ø§ Ù…Ù† Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§Ø´ÛŒØ¯:<br><a href="mailto:irdadgostar@gmail.com">irdadgostar@gmail.com</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 - Ú©Ù„ÛŒÙ‡ Ø­Ù‚ÙˆÙ‚ Ø§ÛŒÙ† Ø¢Ø«Ø§Ø± Ø¨Ø±Ø§ÛŒ Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø¯Ø§Ø¯Ú¯Ø³ØªØ± Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª.</p>
            </div>
        </div>
    </footer>

    <!-- Modal HTML (Unaltered) -->
    <div id="modal-container">
        <div id="modal-content">
            <header id="modal-header">
                <h2 id="modal-title"></h2>
                <button id="modal-close" aria-label="Ø¨Ø³ØªÙ†">&times;</button>
            </header>
            <div id="modal-body">
                <div class="item-image-wrapper" id="modal-image-container" style="display: none; margin-bottom: 1.5rem;">
                    <div class="image-shimmer"></div>
                    <img id="modal-image" class="item-image" src="" alt="ØªØµÙˆÛŒØ± Ø§Ø«Ø±">
                </div>
                <div id="modal-description-wrapper">
                    <pre id="modal-code-content"></pre>
                </div>
            </div>
            <footer id="modal-footer">
                <a href="#" id="modal-link" class="view-button" target="_blank" rel="noopener noreferrer">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯</a>
            </footer>
        </div>
    </div>

    <script defer>
        // JavaScript code remains exactly the same as the previous perfect version.
        // No changes needed here as it controls functionality, not appearance.
        document.addEventListener('DOMContentLoaded', () => {
            const SPREADSHEET_ID = '1A1_02ooUIz7c_9deCuUzHXUknM2VpTGY0-W4vMI4kxs';
            const API_URL = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json`;

            const publicationContainer = document.getElementById('publication-container');
            const searchInput = document.getElementById('search-input');
            const noResultsMsg = document.getElementById('no-results');
            
            let allPublications = [];

            function displaySkeletons(count = 6) {
                const skeletonsHTML = Array(count).fill('').map(() => `
                    <div class="publication-item">
                        <div class="item-image-wrapper"><div class="image-shimmer"></div></div>
                        <div class="item-content">
                            <div class="item-title-wrapper">
                                <div style="height: 1.2em; width: 80%; margin-bottom: 0.5em; background-color: #e9ecef; border-radius: 4px;"></div>
                                <div style="height: 1.2em; width: 60%; background-color: #e9ecef; border-radius: 4px;"></div>
                            </div>
                            <div style="height: 0.9em; width: 40%; background-color: #e9ecef; border-radius: 4px;"></div>
                        </div>
                    </div>
                `).join('');
                publicationContainer.innerHTML = skeletonsHTML;
            }

            function loadImage(imgElement, imageUrl) {
                const shimmer = imgElement.previousElementSibling;
                const tempImg = new Image();
                tempImg.src = imageUrl;
                tempImg.onload = () => {
                    imgElement.src = imageUrl;
                    imgElement.classList.add('loaded');
                    if (shimmer) shimmer.style.display = 'none';
                };
                tempImg.onerror = () => {
                    imgElement.parentElement.style.display = 'none';
                };
            }

            async function fetchPublications() {
                try {
                    const response = await fetch(API_URL);
                    const text = await response.text();
                    const jsonText = text.match(/google\.visualization\.Query\.setResponse\((.*)\)/s)[1];
                    const data = JSON.parse(jsonText);
                    return data.table.rows.map(row => ({
                        date: row.c[0]?.f || row.c[0]?.v || 'Ø¨Ø¯ÙˆÙ† ØªØ§Ø±ÛŒØ®',
                        title: row.c[1]?.v || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†',
                        description: row.c[2]?.v || '',
                        link: row.c[3]?.v || '#',
                        image: row.c[4]?.v || null
                    }));
                } catch (error) {
                    publicationContainer.innerHTML = '<p>Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª.</p>';
                    return [];
                }
            }

            function renderPublications(publications) {
                if (!publications || publications.length === 0) {
                    noResultsMsg.style.display = 'block';
                    publicationContainer.innerHTML = '';
                    return;
                }
                noResultsMsg.style.display = 'none';
                publicationContainer.innerHTML = publications.map(pub => `
                    <article class="publication-item" tabindex="0" data-publication='${escapeHTML(JSON.stringify(pub))}'>
                        ${pub.image ? `
                        <div class="item-image-wrapper">
                            <div class="image-shimmer"></div>
                            <img class="item-image" alt="ØªØµÙˆÛŒØ± Ø¨Ø±Ø§ÛŒ ${escapeHTML(pub.title)}">
                        </div>` : ''}
                        <div class="item-content">
                            <div class="item-title-wrapper">
                                <h3 class="item-title">${escapeHTML(pub.title)}</h3>
                            </div>
                            <p class="item-date">${escapeHTML(pub.date)}</p>
                        </div>
                    </article>
                `).join('');

                const itemsToObserve = publicationContainer.querySelectorAll('.publication-item');
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const item = entry.target;
                            const pubData = JSON.parse(item.dataset.publication);
                            const imgElement = item.querySelector('.item-image');
                            if (imgElement && !imgElement.src) {
                                loadImage(imgElement, pubData.image);
                            }
                            observer.unobserve(item);
                        }
                    });
                }, { rootMargin: '0px 0px 200px 0px' });
                itemsToObserve.forEach(item => imageObserver.observe(item));
            }

            const modal = {
                container: document.getElementById('modal-container'),
                title: document.getElementById('modal-title'),
                closeBtn: document.getElementById('modal-close'),
                imageContainer: document.getElementById('modal-image-container'),
                image: document.getElementById('modal-image'),
                descriptionWrapper: document.getElementById('modal-description-wrapper'),
                codeContent: document.getElementById('modal-code-content'),
                link: document.getElementById('modal-link'),

                open(pubData) {
                    this.title.textContent = pubData.title;
                    this.link.href = pubData.link;

                    if (pubData.description) {
                        this.descriptionWrapper.style.display = 'block';
                        this.codeContent.textContent = pubData.description;
                    } else {
                        this.descriptionWrapper.style.display = 'none';
                    }

                    if (pubData.image) {
                        this.imageContainer.style.display = 'block';
                        this.image.className = 'item-image';
                        this.image.src = '';
                        loadImage(this.image, pubData.image);
                    } else {
                        this.imageContainer.style.display = 'none';
                    }

                    this.container.style.display = 'flex';
                    setTimeout(() => this.container.classList.add('visible'), 10);
                },
                close() {
                    this.container.classList.remove('visible');
                    setTimeout(() => this.container.style.display = 'none', 300);
                },
                init() {
                    this.closeBtn.addEventListener('click', () => this.close());
                    this.container.addEventListener('click', e => {
                        if (e.target === this.container) this.close();
                    });
                    document.addEventListener('keydown', e => {
                        if (e.key === 'Escape' && this.container.classList.contains('visible')) this.close();
                    });
                }
            };
            modal.init();

            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.toLowerCase();
                const filtered = allPublications.filter(p => p.title.toLowerCase().includes(searchTerm));
                renderPublications(filtered);
            });

            publicationContainer.addEventListener('click', e => {
                const item = e.target.closest('.publication-item');
                if (item) modal.open(JSON.parse(item.dataset.publication));
            });
            publicationContainer.addEventListener('keydown', e => {
                if (e.key === 'Enter' && e.target.closest('.publication-item')) {
                     e.preventDefault();
                     modal.open(JSON.parse(e.target.dataset.publication));
                }
            });
            
            function escapeHTML(str) {
                return str.replace(/'/g, '&#039;').replace(/"/g, '&quot;');
            }

            async function main() {
                displaySkeletons();
                allPublications = await fetchPublications();
                renderPublications(allPublications);
            }

            main();
        });
    </script>
</body>
</html>
