<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ====================
       ADVANCED MULTILINGUAL SEO
       ==================== -->

    <!-- 1. Primary Title (Persian + English) -->
    <title>امیرحسین دادگستر | پژوهش‌ها  (Amirhossein Dadgostar)</title>

    <!-- 2. Primary Description -->
    <meta name="description" content="آرشیو دیجیتال و وب‌سایت رسمی امیرحسین دادگستر (Amirhossein Dadgostar). مجموعه آثار در حوزه‌های علوم اسلامی، قرآن‌شناسی، فقه و حقوق.">

    <!-- 3. Multilingual Keywords -->
    <meta name="keywords" content="امیرحسین دادگستر, Amirhossein Dadgostar, Amir Dadgostar, أمير حسين دادگستر, 阿米尔侯赛因·达戈斯塔, अमीरहोसैन दादगोस्तार, アミルフセイン・ダドゴスタル, 아미르호세인 다드고스타르, پژوهشگر اسلامی, علوم اسلامی">
    
    <meta name="author" content="امیرحسین دادگستر">

    <!-- 4. Canonical URL (The Official Address) -->
    <link rel="canonical" href="https://irdadgostar.github.io/">

    <!-- 5. Language Alternates (hreflang) -->
    <link rel="alternate" hreflang="fa" href="https://irdadgostar.github.io/">
    <link rel="alternate" hreflang="x-default" href="https://irdadgostar.github.io/">

    <!-- 6. Open Graph Meta Tags (for Social Media Sharing) -->
    <meta property="og:title" content="امیرحسین دادگستر | پژوهش‌ها و آثار (Amirhossein Dadgostar)">
    <meta property="og:description" content="آرشیو دیجیتال آثار امیرحسین دادگستر در حوزه‌های علوم اسلامی، قرآن‌شناسی و تربیت.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://irdadgostar.github.io/">
    <!-- <meta property="og:image" content="https://irdadgostar.github.io/link-to-your-image.jpg"> -->

    <!-- 7. Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="امیرحسین دادگستر | پژوهش‌ها و آثار (Amirhossein Dadgostar)">
    <meta name="twitter:description" content="آرشیو دیجیتال آثار امیرحسین دادگستر.">
    <!-- <meta name="twitter:image" content="https://irdadgostar.github.io/link-to-your-image.jpg"> -->

    <!-- ====================
       THE SECRET WEAPON: STRUCTURED DATA (SCHEMA.ORG)
       ==================== -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Person",
          "name": "امیرحسین دادگستر",
          "url": "https://irdadgostar.github.io/",
          "sameAs": [], // Add links to your social media profiles here, e.g., "https://www.linkedin.com/in/yourprofile"
          "jobTitle": "پژوهشگر و مؤلف",
          "description": "پژوهشگر در حوزه‌های علوم اسلامی، قرآن‌شناسی، فقه و حقوق.",
          "alternateName": [
            "Amirhossein Dadgostar",
            "Amir Dadgostar",
            "أمير حسين دادگستر",
            "阿米尔侯赛因·达戈斯塔",
            "अमीरहोसैन दादगोस्तार",
            "アミルフセイン・ダドゴスタル",
            "아미르호세인 다드고스타르"
          ]
        },
        {
          "@type": "WebSite",
          "url": "https://irdadgostar.github.io/",
          "name": "امیرحسین دادگستر | پژوهش‌ها و آثار",
          "author": {
            "@type": "Person",
            "name": "امیرحسین دادگستر"
          },
          "publisher": {
            "@type": "Person",
            "name": "امیرحسین دادگستر"
          }
        }
      ]
    }
    </script>

    <!-- Preload Fonts for Performance -->
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

    <style>
        /* CSS code remains exactly the same as the previous perfect version */
        :root {
            --bg-color: #f8f9fa;
            --surface-color: #ffffff;
            --primary-color: #0056b3;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --border-color: #dee2e6;
            --shadow-color: rgba(0, 0, 0, 0.05);
            --font-family: 'Vazirmatn', -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            --border-radius: 8px;
            --transition-speed: 0.25s;
        }

        @font-face { font-family: 'Vazirmatn'; src: url('https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-Regular.woff2') format('woff2'); font-weight: 400; font-display: swap; }
        @font-face { font-family: 'Vazirmatn'; src: url('https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-Bold.woff2') format('woff2'); font-weight: 700; font-display: swap; }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 16px;
        }
        .container { max-width: 1140px; margin: 0 auto; padding: 0 1.5rem; }

        .header {
            position: sticky; top: 0;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid var(--border-color);
            z-index: 1000;
            padding: 1rem 0;
        }
        .nav-container { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--text-primary); text-decoration: none; }
        .nav-menu { display: flex; list-style: none; gap: 2rem; }
        .nav-link { color: var(--text-secondary); text-decoration: none; font-weight: 500; padding: 0.5rem 0; position: relative; transition: color var(--transition-speed) ease; }
        .nav-link::after { content: ''; position: absolute; bottom: 0; right: 0; width: 0; height: 2px; background-color: var(--primary-color); transition: width var(--transition-speed) ease; }
        .nav-link:hover, .nav-link.active { color: var(--primary-color); }
        .nav-link.active::after { width: 100%; }

        .page-section { padding: 4rem 0; }
        .section-header { text-align: center; margin-bottom: 3rem; }
        .section-header h2 { font-size: 2.5rem; font-weight: 700; }

        .search-wrapper { max-width: 720px; margin: 0 auto 3rem auto; }
        #search-input { width: 100%; padding: 0.8rem 1.2rem; font-family: var(--font-family); font-size: 1rem; border: 1px solid var(--border-color); border-radius: var(--border-radius); transition: border-color var(--transition-speed), box-shadow var(--transition-speed); }
        #search-input:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.1); }

        .publication-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }
        .publication-item { display: flex; flex-direction: column; background-color: var(--surface-color); border: 1px solid var(--border-color); border-radius: var(--border-radius); box-shadow: 0 2px 5px var(--shadow-color); transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease; cursor: pointer; overflow: hidden; }
        .publication-item:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08); }

        .item-image-wrapper { width: 100%; aspect-ratio: 16 / 9; position: relative; background-color: #f0f3f7; }
        .image-shimmer { position: absolute; inset: 0; background: linear-gradient(100deg, rgba(255,255,255,0) 20%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0) 80%), #f0f3f7; background-size: 200% 100%; animation: shimmer 1.5s infinite linear; }
        @keyframes shimmer { from { background-position: 200% 0; } to { background-position: -200% 0; } }
        .item-image { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 0.5s ease; }
        .item-image.loaded { opacity: 1; }

        .item-content { padding: 1.25rem; display: flex; flex-direction: column; flex-grow: 1; }
        .item-title-wrapper { flex-grow: 1; }
        .item-title { font-size: 1.2rem; font-weight: 700; line-height: 1.5; margin-bottom: 0.5rem; color: var(--text-primary); }
        .item-date { font-size: 0.9rem; color: var(--text-secondary); }
        #no-results { display: none; text-align: center; padding: 2rem; color: var(--text-secondary); }

        #modal-container { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px); z-index: 10000; opacity: 0; transition: opacity var(--transition-speed) ease; }
        #modal-container.visible { opacity: 1; }
        #modal-content { background-color: var(--surface-color); width: 90%; max-width: 700px; max-height: 90vh; display: flex; flex-direction: column; border-radius: var(--border-radius); box-shadow: 0 5px 20px rgba(0,0,0,0.1); transform: scale(0.95); transition: transform var(--transition-speed) ease; }
        #modal-container.visible #modal-content { transform: scale(1); }
        #modal-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
        #modal-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); }
        #modal-close { background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--text-secondary); line-height: 1; }
        #modal-body { padding: 1.5rem; overflow-y: auto; }
        #modal-description-wrapper {
            background-color: #f8f9fa; 
            border: 1px solid var(--border-color); 
            padding: 1rem; 
            border-radius: 6px; 
            font-size: 0.95rem;
            direction: rtl;
            text-align: right;
        }
        #modal-description-wrapper pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: var(--font-family);
        }
        #modal-footer { padding: 1rem 1.5rem; border-top: 1px solid var(--border-color); text-align: left; flex-shrink: 0; }
        .view-button { display: inline-block; padding: 0.6rem 1.2rem; background-color: var(--primary-color); color: #fff; text-decoration: none; border-radius: 6px; font-weight: 500; transition: background-color var(--transition-speed); }
        .view-button:hover { background-color: #004494; }

        .footer { padding: 3rem 0; background-color: #e9ecef; border-top: 1px solid var(--border-color); margin-top: 4rem; }
        .footer-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 3rem; }
        .footer-col h3 { margin-bottom: 1rem; font-size: 1.2rem; }
        .footer-col p, .footer-col a { color: var(--text-secondary); text-decoration: none; }
        .footer-col a:hover { color: var(--primary-color); }
        .footer-bottom { text-align: center; margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color); color: var(--text-secondary); font-size: 0.9rem; }

        @media (max-width: 768px) {
            .nav-menu { display: none; }
            .footer-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container nav-container">
            <a href="#" class="logo">امیرحسین دادگستر</a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#" class="nav-link active">آثار</a></li>
                    <li><a href="#footer" class="nav-link">تماس</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section id="publications" class="page-section">
            <div class="container">
                <div class="section-header">
                    <h2>ماحصل</h2>
                </div>
                <div class="search-wrapper">
                    <input type="text" id="search-input" placeholder="جستجو در میان آثار...">
                </div>
                <div id="publication-container" class="publication-grid">
                    <!-- Skeletons & Content will be injected here -->
                </div>
                <p id="no-results">هیچ اثری با این مشخصات یافت نشد.</p>
            </div>
        </section>
    </main>

    <footer id="footer" class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>درباره من</h3>
                    <p>من امیرحسین دادگستر هستم.علاقه مند در زمینه های مختلف. این وب‌سایت آرشیوی از یاداشت‌های من است. </p>
                </div>
                <div class="footer-col">
                    <h3>تماس</h3>
                    <p>می‌توانید از طریق ایمیل زیر با من در ارتباط باشید:<br><a href="mailto:irdadgostar@gmail.com">irdadgostar@gmail.com</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 - کلیه حقوق این آثار برای امیرحسین دادگستر محفوظ است.</p>
            </div>
        </div>
    </footer>

    <!-- Modal HTML -->
    <div id="modal-container">
        <div id="modal-content">
            <header id="modal-header">
                <h2 id="modal-title"></h2>
                <button id="modal-close" aria-label="بستن">&times;</button>
            </header>
            <div id="modal-body">
                <div class="item-image-wrapper" id="modal-image-container" style="display: none; margin-bottom: 1.5rem;">
                    <div class="image-shimmer"></div>
                    <img id="modal-image" class="item-image" src="" alt="تصویر اثر">
                </div>
                <div id="modal-description-wrapper">
                    <pre id="modal-code-content"></pre>
                </div>
            </div>
            <footer id="modal-footer">
                <a href="#" id="modal-link" class="view-button" target="_blank" rel="noopener noreferrer">مشاهده و دانلود</a>
            </footer>
        </div>
    </div>

    <script defer>
        // JavaScript code remains exactly the same as the previous perfect version
        document.addEventListener('DOMContentLoaded', () => {
            const SPREADSHEET_ID = '1A1_02ooUIz7c_9deCuUzHXUknM2VpTGY0-W4vMI4kxs';
            const API_URL = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json`;

            const publicationContainer = document.getElementById('publication-container');
            const searchInput = document.getElementById('search-input');
            const noResultsMsg = document.getElementById('no-results');
            
            let allPublications = [];

            function displaySkeletons(count = 6) {
                const skeletonsHTML = Array(count).fill('').map(() => `
                    <div class="publication-item">
                        <div class="item-image-wrapper"><div class="image-shimmer"></div></div>
                        <div class="item-content">
                            <div class="item-title-wrapper">
                                <div style="height: 1.2em; width: 80%; margin-bottom: 0.5em; background-color: #e9ecef; border-radius: 4px;"></div>
                                <div style="height: 1.2em; width: 60%; background-color: #e9ecef; border-radius: 4px;"></div>
                            </div>
                            <div style="height: 0.9em; width: 40%; background-color: #e9ecef; border-radius: 4px;"></div>
                        </div>
                    </div>
                `).join('');
                publicationContainer.innerHTML = skeletonsHTML;
            }

            function loadImage(imgElement, imageUrl) {
                const shimmer = imgElement.previousElementSibling;
                const tempImg = new Image();
                tempImg.src = imageUrl;
                tempImg.onload = () => {
                    imgElement.src = imageUrl;
                    imgElement.classList.add('loaded');
                    if (shimmer) shimmer.style.display = 'none';
                };
                tempImg.onerror = () => {
                    imgElement.parentElement.style.display = 'none';
                };
            }

            async function fetchPublications() {
                try {
                    const response = await fetch(API_URL);
                    const text = await response.text();
                    const jsonText = text.match(/google\.visualization\.Query\.setResponse\((.*)\)/s)[1];
                    const data = JSON.parse(jsonText);
                    return data.table.rows.map(row => ({
                        date: row.c[0]?.f || row.c[0]?.v || 'بدون تاریخ',
                        title: row.c[1]?.v || 'بدون عنوان',
                        description: row.c[2]?.v || '',
                        link: row.c[3]?.v || '#',
                        image: row.c[4]?.v || null
                    }));
                } catch (error) {
                    publicationContainer.innerHTML = '<p>خطا در بارگذاری اطلاعات.</p>';
                    return [];
                }
            }

            function renderPublications(publications) {
                if (!publications || publications.length === 0) {
                    noResultsMsg.style.display = 'block';
                    publicationContainer.innerHTML = '';
                    return;
                }
                noResultsMsg.style.display = 'none';
                publicationContainer.innerHTML = publications.map(pub => `
                    <article class="publication-item" tabindex="0" data-publication='${escapeHTML(JSON.stringify(pub))}'>
                        ${pub.image ? `
                        <div class="item-image-wrapper">
                            <div class="image-shimmer"></div>
                            <img class="item-image" alt="تصویر برای ${escapeHTML(pub.title)}">
                        </div>` : ''}
                        <div class="item-content">
                            <div class="item-title-wrapper">
                                <h3 class="item-title">${escapeHTML(pub.title)}</h3>
                            </div>
                            <p class="item-date">${escapeHTML(pub.date)}</p>
                        </div>
                    </article>
                `).join('');

                const itemsToObserve = publicationContainer.querySelectorAll('.publication-item');
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const item = entry.target;
                            const pubData = JSON.parse(item.dataset.publication);
                            const imgElement = item.querySelector('.item-image');
                            if (imgElement && !imgElement.src) {
                                loadImage(imgElement, pubData.image);
                            }
                            observer.unobserve(item);
                        }
                    });
                }, { rootMargin: '0px 0px 200px 0px' });
                itemsToObserve.forEach(item => imageObserver.observe(item));
            }

            const modal = {
                container: document.getElementById('modal-container'),
                title: document.getElementById('modal-title'),
                closeBtn: document.getElementById('modal-close'),
                imageContainer: document.getElementById('modal-image-container'),
                image: document.getElementById('modal-image'),
                descriptionWrapper: document.getElementById('modal-description-wrapper'),
                codeContent: document.getElementById('modal-code-content'),
                link: document.getElementById('modal-link'),

                open(pubData) {
                    this.title.textContent = pubData.title;
                    this.link.href = pubData.link;

                    if (pubData.description) {
                        this.descriptionWrapper.style.display = 'block';
                        this.codeContent.textContent = pubData.description;
                    } else {
                        this.descriptionWrapper.style.display = 'none';
                    }

                    if (pubData.image) {
                        this.imageContainer.style.display = 'block';
                        this.image.className = 'item-image';
                        this.image.src = '';
                        loadImage(this.image, pubData.image);
                    } else {
                        this.imageContainer.style.display = 'none';
                    }

                    this.container.style.display = 'flex';
                    setTimeout(() => this.container.classList.add('visible'), 10);
                },
                close() {
                    this.container.classList.remove('visible');
                    setTimeout(() => this.container.style.display = 'none', 300);
                },
                init() {
                    this.closeBtn.addEventListener('click', () => this.close());
                    this.container.addEventListener('click', e => {
                        if (e.target === this.container) this.close();
                    });
                    document.addEventListener('keydown', e => {
                        if (e.key === 'Escape' && this.container.classList.contains('visible')) this.close();
                    });
                }
            };
            modal.init();

            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.toLowerCase();
                const filtered = allPublications.filter(p => p.title.toLowerCase().includes(searchTerm));
                renderPublications(filtered);
            });

            publicationContainer.addEventListener('click', e => {
                const item = e.target.closest('.publication-item');
                if (item) modal.open(JSON.parse(item.dataset.publication));
            });
            publicationContainer.addEventListener('keydown', e => {
                if (e.key === 'Enter' && e.target.closest('.publication-item')) {
                     e.preventDefault();
                     modal.open(JSON.parse(e.target.dataset.publication));
                }
            });
            
            function escapeHTML(str) {
                return str.replace(/'/g, '&#039;').replace(/"/g, '&quot;');
            }

            async function main() {
                displaySkeletons();
                allPublications = await fetchPublications();
                renderPublications(allPublications);
            }

            main();
        });
    </script>
</body>
</html>
